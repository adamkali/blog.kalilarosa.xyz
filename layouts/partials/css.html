{{ with (templates.Defer (dict "key" "global")) }}
  {{ with resources.Get "css/main.css" }}
    {{ $opts := dict
      "minify" (not hugo.IsDevelopment)
      "inlineImports" true
      "autoprefixer" true
    }}
    {{ with . | css.TailwindCSS $opts | minify }}
      {{ if hugo.IsDevelopment }}
        <link rel="stylesheet" href="{{ .Permalink | relURL }}">
      {{ else }}
        {{ with . | fingerprint }}
          <link rel="preload" href="{{ .Permalink | relURL }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
          <noscript><link rel="stylesheet" href="{{ .Permalink | relURL }}" integrity="{{ .Data.Integrity }}" crossorigin="anonymous"></noscript>
        {{ end }}
      {{ end }}
    {{ end }}
  {{ end }}
{{ end }}
